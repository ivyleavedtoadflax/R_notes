<html>

<head>
<style type="text/css">
.knitr.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
},
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0em 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage.left {
  text-align: left;
}
.rimage.right {
  text-align: right;
}
.rimage.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>Getting Started with R - Data structures</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css">

</head>

<body>

<a class="next" href="selecting_data.html">Previous...Selecting data</a>

<br><hr class="ex1"><br>

<h1>Data structures</h1>

<p>You may have noticed that we have already dealt with two of the different types of data structures - or more correctly - 'objects' available in R. We created vectors using the <tt>c()</tt> and <tt>scan()</tt> commands, whilst we most of the data we have imported so far has been in the <tt>dataframe</tt> format.</p>

<p>I'm going to talk a little about the different types here, just to make you aware, but a much better discussion can be found <a href="http://cran.r-project.org/doc/manuals/R-lang.pdf">here</a>.</p>

<h2>Vectors, lists, and matrices</h2>

<h3>Vectors</h3>

<p>A <tt>vector</tt> can be thought of as a list of contiguous cells, like the first column of a spreadsheet. When we use the methods <tt>c()</tt>, and <tt>scan</tt>, or indeed <tt>seq()</tt>, this is what we will end up with, and when you call a <tt>vector</tt>, you end up with a list of numbers (or other data) displayed horizontally in the console.</p>

<p>Vectors can contain numbers or characters, or booleans (TRUE/FALSE), but they cannot be a mix, they must always contain the same type of data.</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">seq</span><span class="hl std">(</span>
     <span class="hl kwc">from</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span>
     <span class="hl kwc">to</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>
     <span class="hl kwc">length.out</span> <span class="hl std">=</span> <span class="hl num">8</span>
     <span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 1.000 1.143 1.286 1.429 1.571 1.714 1.857 2.000
</pre></div>
</div></div>


<h3>Lists</h3>

<p>A <tt>list</tt> can be thought of as a collection of one or more named <tt>vector</tt> of potentially different types. In a list, you can stored many different types of data of different lengths.</p>

<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">our_list</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">list</span><span class="hl std">(</span>
     <span class="hl kwc">m_names</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Andrew&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Bradley&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Charles&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Derrick&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Edmond&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Frank&quot;</span><span class="hl std">),</span>
     <span class="hl kwc">f_names</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Georgina&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Heidi&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Isabelle&quot;</span><span class="hl std">),</span>
     <span class="hl kwc">age</span> <span class="hl std">=</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">20</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">),</span>
     <span class="hl kwc">t_f</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">TRUE</span><span class="hl std">,</span><span class="hl num">FALSE</span><span class="hl std">,</span><span class="hl num">TRUE</span><span class="hl std">,</span><span class="hl num">FALSE</span><span class="hl std">)</span>
     <span class="hl std">)</span>
<span class="hl std">our_list</span>
</pre></div>
<div class="output"><pre class="knitr r">## $m_names
## [1] "Andrew"  "Bradley" "Charles" "Derrick" "Edmond"  "Frank"  
## 
## $f_names
## [1] "Georgina" "Heidi"    "Isabelle"
## 
## $age
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
## 
## $t_f
## [1]  TRUE FALSE  TRUE FALSE
</pre></div>
</div></div>


<p>Note that if we only want to call one <tt>vector</tt> from within <tt>our_list</tt>, we must subset it with:</p>

<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">our_list</span><span class="hl opt">$</span><span class="hl std">m_names</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] "Andrew"  "Bradley" "Charles" "Derrick" "Edmond"  "Frank"
</pre></div>
</div></div>


<p>Or...</p>

<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">our_list[</span><span class="hl num">1</span><span class="hl std">]</span>
</pre></div>
<div class="output"><pre class="knitr r">## $m_names
## [1] "Andrew"  "Bradley" "Charles" "Derrick" "Edmond"  "Frank"
</pre></div>
</div></div>


<p>Lists are useful if you write you own functions, but in practice they are not useful when completing statistical analysis. By the end of this tutorial however, you encounter at least one instance when you need to use a <tt>list</tt>: the <tt>split</tt> function.</p>

<h3>Matrices</h3>

<p>If a <tt>vector</tt> can be thought of as a column in a spreadsheet, a <tt>matrix</tt> can be thought of as one of more columns bound together. A <tt>matrix</tt> is essentially a spreadsheet as we would think about it. Sometimes the best way to view a <tt>matrix</tt> is to use <tt>fix()</tt> or <tt>View()</tt>.</p>

<p>We can make a <tt>matrix</tt> with a call to <tt>matrix()</tt></p>

<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">our_matrix</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">matrix</span><span class="hl std">(</span><span class="hl kwc">ncol</span> <span class="hl std">=</span> <span class="hl num">5</span><span class="hl std">,</span> <span class="hl kwc">nrow</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">)</span>
<span class="hl std">our_matrix</span>
</pre></div>
<div class="output"><pre class="knitr r">##       [,1] [,2] [,3] [,4] [,5]
##  [1,]   NA   NA   NA   NA   NA
##  [2,]   NA   NA   NA   NA   NA
##  [3,]   NA   NA   NA   NA   NA
##  [4,]   NA   NA   NA   NA   NA
##  [5,]   NA   NA   NA   NA   NA
##  [6,]   NA   NA   NA   NA   NA
##  [7,]   NA   NA   NA   NA   NA
##  [8,]   NA   NA   NA   NA   NA
##  [9,]   NA   NA   NA   NA   NA
## [10,]   NA   NA   NA   NA   NA
</pre></div>
</div></div>


<p>Here we created a matrix with 50 columns and ten rows. Again, if we want to select part of the matrix, we need to use subsets <tt>[,]</tt>.</p>

<div class="chunk" id="unnamed-chunk-6"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">our_matrix[</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">2</span><span class="hl std">, ]</span>
</pre></div>
<div class="output"><pre class="knitr r">##      [,1] [,2] [,3] [,4] [,5]
## [1,]   NA   NA   NA   NA   NA
## [2,]   NA   NA   NA   NA   NA
</pre></div>
</div></div>


<p>And we can populate our matrices in a similar way...</p>

<div class="chunk" id="unnamed-chunk-7"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">our_matrix[, ]</span> <span class="hl kwb">&lt;-</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">50</span>
<span class="hl std">our_matrix</span>
</pre></div>
<div class="output"><pre class="knitr r">##       [,1] [,2] [,3] [,4] [,5]
##  [1,]    1   11   21   31   41
##  [2,]    2   12   22   32   42
##  [3,]    3   13   23   33   43
##  [4,]    4   14   24   34   44
##  [5,]    5   15   25   35   45
##  [6,]    6   16   26   36   46
##  [7,]    7   17   27   37   47
##  [8,]    8   18   28   38   48
##  [9,]    9   19   29   39   49
## [10,]   10   20   30   40   50
</pre></div>
</div></div>


<p>Note how the numbers were distributed in the matrix. And, of course, we can subset a smaller part of the matrix:</p>

<div class="chunk" id="unnamed-chunk-8"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">our_matrix[</span><span class="hl num">4</span><span class="hl opt">:</span><span class="hl num">7</span><span class="hl std">,</span> <span class="hl num">2</span><span class="hl opt">:</span><span class="hl num">4</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl std">letters[</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">4</span><span class="hl std">]</span>
<span class="hl std">our_matrix</span>
</pre></div>
<div class="output"><pre class="knitr r">##       [,1] [,2] [,3] [,4] [,5]
##  [1,] "1"  "11" "21" "31" "41"
##  [2,] "2"  "12" "22" "32" "42"
##  [3,] "3"  "13" "23" "33" "43"
##  [4,] "4"  "a"  "a"  "a"  "44"
##  [5,] "5"  "b"  "b"  "b"  "45"
##  [6,] "6"  "c"  "c"  "c"  "46"
##  [7,] "7"  "d"  "d"  "d"  "47"
##  [8,] "8"  "18" "28" "38" "48"
##  [9,] "9"  "19" "29" "39" "49"
## [10,] "10" "20" "30" "40" "50"
</pre></div>
</div></div>


<p>Note that in this example the once numeric matrix has been converted to characters (denoted by the " marks), as we have included letters - like a vector, a matrix can only be one thing: number, boolean, character, etc.</p>

<p>Note that it is possible to convert between the data types. We can change a vector into a matrix:</p>

<div class="chunk" id="unnamed-chunk-9"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">our_vector</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span> <span class="hl num">10</span><span class="hl std">,</span> <span class="hl num">1</span><span class="hl std">)</span>
<span class="hl std">our_vector</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1]  1  2  3  4  5  6  7  8  9 10
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">our_vector_matrix</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(our_vector)</span>
<span class="hl std">our_vector_matrix</span>
</pre></div>
<div class="output"><pre class="knitr r">##       [,1]
##  [1,]    1
##  [2,]    2
##  [3,]    3
##  [4,]    4
##  [5,]    5
##  [6,]    6
##  [7,]    7
##  [8,]    8
##  [9,]    9
## [10,]   10
</pre></div>
</div></div>


<p>And we can do the opposite operation...</p>

<div class="chunk" id="unnamed-chunk-10"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">as.vector</span><span class="hl std">(our_vector_matrix)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1]  1  2  3  4  5  6  7  8  9 10
</pre></div>
</div></div>



<p>This may seem a bit academic...what difference does it really make if your data is a vector or a matrix? Well not a great deal, in truth, but there are occasions when your code will slip up because your data is in the wrong format. Two useful functions to learn are <tt>as.</tt> followed by matrix/vector/list/data.frame, and <tt>is.</tt> followed by the same. The latter is useful to interrogate what an object is without converting it - this comes in very handy when dealing with functions you do not know.</p>

<div class="chunk" id="unnamed-chunk-11"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">is.data.frame</span><span class="hl std">(our_vector_matrix)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] FALSE
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">is.list</span><span class="hl std">(our_vector_matrix)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] FALSE
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">is.vector</span><span class="hl std">(our_vector_matrix)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] FALSE
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">is.matrix</span><span class="hl std">(our_vector_matrix)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] TRUE
</pre></div>
</div></div>


<h3>Dataframes</h3>

<h2>Long and wide data</h2>

<p>The astute among you may have noticed, that although I have recommended that you save your data in 'long' format, all the datasets loaded from R and elsewhere, so far, have been in 'wide' rather than 'long' format.</p>

<p>What exactly do we mean by the terms 'long' and 'wide'? And why does it really matter. To give you an example, we'll simulate some data to practice on. This data consist

<p>In this example we will create our own dataset by randomly generating values along a uniform distribution. We'll use a soil science example. We simulate data for an experiment in whcih 144 samples of bulk density <tt>bd</tt>, and organic carbon <tt>oc</tt> were collected in 3 replicate <tt>blocks</tt>, 4 <tt>treatments</tt>, and at 6 <tt>depths</tt>.</p>

<div class="chunk" id="unnamed-chunk-12"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">1337</span><span class="hl std">)</span>
<span class="hl com"># For brevity these commands have been called lazily!</span>
<span class="hl std">oc_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl std">(</span>
     <span class="hl kwc">block</span> <span class="hl std">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">3</span><span class="hl std">,</span><span class="hl kwc">each</span><span class="hl std">=</span><span class="hl num">4</span><span class="hl std">),</span><span class="hl kwc">length.out</span><span class="hl std">=</span><span class="hl num">144</span><span class="hl std">),</span>
     <span class="hl kwc">treatment</span> <span class="hl std">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl kwd">rep</span><span class="hl std">(LETTERS[</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">4</span><span class="hl std">],</span><span class="hl kwc">length</span><span class="hl std">=</span><span class="hl num">24</span><span class="hl std">),</span><span class="hl kwc">length.out</span><span class="hl std">=</span><span class="hl num">144</span><span class="hl std">),</span>
     <span class="hl kwc">depth</span> <span class="hl std">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">6</span><span class="hl std">,</span><span class="hl kwc">each</span><span class="hl std">=</span><span class="hl num">24</span><span class="hl std">),</span>
     <span class="hl kwc">oc</span> <span class="hl std">=</span> <span class="hl kwd">rev</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">5</span><span class="hl std">,</span><span class="hl num">3</span><span class="hl std">,</span><span class="hl num">2.2</span><span class="hl std">,</span><span class="hl num">1.8</span><span class="hl std">,</span><span class="hl num">1.2</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">)</span><span class="hl opt">+</span><span class="hl kwd">runif</span><span class="hl std">(</span><span class="hl num">144</span><span class="hl std">,</span><span class="hl kwc">max</span><span class="hl std">=</span><span class="hl num">1.5</span><span class="hl std">,</span><span class="hl kwc">min</span><span class="hl std">=</span><span class="hl num">1.5</span><span class="hl std">)</span><span class="hl opt">+</span><span class="hl kwd">rexp</span><span class="hl std">(</span><span class="hl num">144</span><span class="hl std">,</span><span class="hl kwc">rate</span><span class="hl std">=</span><span class="hl num">10</span><span class="hl std">)))),</span>
     <span class="hl kwc">bd</span> <span class="hl std">=</span> <span class="hl kwd">sort</span><span class="hl std">(</span><span class="hl kwd">runif</span><span class="hl std">(</span><span class="hl num">144</span><span class="hl std">,</span><span class="hl kwc">min</span><span class="hl std">=</span><span class="hl num">0.85</span><span class="hl std">,</span><span class="hl kwc">max</span><span class="hl std">=</span><span class="hl num">1.6</span><span class="hl std">))</span>
     <span class="hl std">)</span>
<span class="hl kwd">head</span><span class="hl std">(oc_data)</span>
</pre></div>
<div class="output"><pre class="knitr r">##   block treatment depth    oc     bd
## 1     1         A     1 7.100 0.8550
## 2     1         B     1 6.938 0.8551
## 3     1         C     1 6.880 0.8576
## 4     1         D     1 6.799 0.8734
## 5     2         A     1 6.743 0.8763
## 6     2         B     1 6.719 0.8847
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">str</span><span class="hl std">(oc_data)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	144 obs. of  5 variables:
##  $ block    : int  1 1 1 1 2 2 2 2 3 3 ...
##  $ treatment: Factor w/ 4 levels "A","B","C","D": 1 2 3 4 1 2 3 4 1 2 ...
##  $ depth    : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ oc       : num  7.1 6.94 6.88 6.8 6.74 ...
##  $ bd       : num  0.855 0.855 0.858 0.873 0.876 ...
</pre></div>
<div class="source"><pre class="knitr r">
</pre></div>
</div></div>


<p>This makes for a reasonably complicated factorial experiment. If we want to get somethign sensible from it, we need to convert it to long format first. We use the package <tt>reshape</tt> to do this...</p>

<div class="chunk" id="unnamed-chunk-13"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(reshape)</span>
</pre></div>
</div></div>



<div class="chunk" id="unnamed-chunk-14"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">oc_data_m</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">melt</span><span class="hl std">(</span>
     <span class="hl std">oc_data,</span>
     <span class="hl kwc">id.vars</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">3</span><span class="hl std">,</span>
     <span class="hl kwc">measure.vars</span> <span class="hl std">=</span> <span class="hl num">4</span><span class="hl opt">:</span><span class="hl num">5</span>
     <span class="hl std">)</span>
<span class="hl kwd">head</span><span class="hl std">(oc_data_m)</span>
</pre></div>
<div class="output"><pre class="knitr r">##   block treatment depth variable value
## 1     1         A     1       oc 7.100
## 2     1         B     1       oc 6.938
## 3     1         C     1       oc 6.880
## 4     1         D     1       oc 6.799
## 5     2         A     1       oc 6.743
## 6     2         B     1       oc 6.719
</pre></div>
<div class="source"><pre class="knitr r">
# I won't run this command for brevity, but you should, just to check the data:

#oc_data_m

</pre></div>
</div></div>


<p>Suppose we want to see the average <tt>bd</tt> and <tt>oc</tt> for each treatment, each depth, and a combination of treatment and depth...</p>

<div class="chunk" id="unnamed-chunk-15"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">cast</span><span class="hl std">(</span>
     <span class="hl std">oc_data_m,</span>
     <span class="hl std">treatment</span> <span class="hl opt">~</span> <span class="hl std">variable,</span>
     <span class="hl std">mean</span>
     <span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">##   treatment    oc    bd
## 1         A 3.979 1.217
## 2         B 3.965 1.223
## 3         C 3.952 1.228
## 4         D 3.942 1.234
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># If we want the standard deviation as well as the mean, we can use:</span>
<span class="hl kwd">cast</span><span class="hl std">(</span>
     <span class="hl std">oc_data_m,</span>
     <span class="hl std">depth</span> <span class="hl opt">~</span> <span class="hl std">variable,</span>
     <span class="hl kwd">c</span><span class="hl std">(mean, sd)</span>
     <span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">##   depth oc_mean   oc_sd bd_mean   bd_sd
## 1     1   6.642 0.15548  0.9202 0.04280
## 2     2   4.576 0.08146  1.0329 0.03709
## 3     3   3.799 0.07755  1.1584 0.02403
## 4     4   3.382 0.07175  1.2807 0.05505
## 5     5   2.772 0.06143  1.4101 0.03244
## 6     6   2.587 0.05605  1.5515 0.03253
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># We can even apply our own custom functions - for example the upper and lower </span>
<span class="hl com"># 95% confidence interval</span>
<span class="hl std">uci95</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">) {</span>
     <span class="hl kwd">mean</span><span class="hl std">(x)</span> <span class="hl opt">+</span> <span class="hl kwd">qt</span><span class="hl std">(</span><span class="hl num">0.975</span><span class="hl std">,</span><span class="hl kwc">df</span> <span class="hl std">=</span> <span class="hl kwd">length</span><span class="hl std">(x)</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">)</span> <span class="hl opt">*</span> <span class="hl kwd">sd</span><span class="hl std">(x)</span> <span class="hl opt">/</span> <span class="hl kwd">sqrt</span><span class="hl std">(</span><span class="hl kwd">length</span><span class="hl std">(x))</span>
<span class="hl std">}</span>
<span class="hl std">lci95</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">) {</span>
     <span class="hl kwd">mean</span><span class="hl std">(x)</span> <span class="hl opt">-</span> <span class="hl kwd">qt</span><span class="hl std">(</span><span class="hl num">0.975</span><span class="hl std">,</span><span class="hl kwc">df</span> <span class="hl std">=</span> <span class="hl kwd">length</span><span class="hl std">(x)</span><span class="hl opt">-</span><span class="hl num">1</span><span class="hl std">)</span> <span class="hl opt">*</span> <span class="hl kwd">sd</span><span class="hl std">(x)</span> <span class="hl opt">/</span> <span class="hl kwd">sqrt</span><span class="hl std">(</span><span class="hl kwd">length</span><span class="hl std">(x))</span>
<span class="hl std">}</span>
<span class="hl com"># and if we are only interested in one variable, and teh top three depths for</span>
<span class="hl com"># instance...., we subset the data</span>
<span class="hl kwd">cast</span><span class="hl std">(</span>
     <span class="hl kwd">subset</span><span class="hl std">(</span>
          <span class="hl std">oc_data_m,</span>
          <span class="hl std">variable</span> <span class="hl opt">==</span> <span class="hl str">&quot;oc&quot;</span> <span class="hl opt">&amp;</span> <span class="hl std">depth</span> <span class="hl opt">&lt;</span> <span class="hl num">4</span><span class="hl std">),</span>
     <span class="hl std">treatment</span> <span class="hl opt">+</span> <span class="hl std">depth</span> <span class="hl opt">~</span> <span class="hl std">variable,</span>
     <span class="hl kwd">c</span><span class="hl std">(mean, sd, lci95, uci95)</span>
     <span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">##    treatment depth oc_mean   oc_sd oc_lci95 oc_uci95
## 1          A     1   6.685 0.22024    6.454    6.916
## 2          A     2   4.594 0.10185    4.487    4.701
## 3          A     3   3.811 0.08436    3.723    3.900
## 4          B     1   6.650 0.16141    6.481    6.819
## 5          B     2   4.581 0.08931    4.487    4.674
## 6          B     3   3.804 0.08327    3.717    3.891
## 7          C     1   6.630 0.13924    6.484    6.776
## 8          C     2   4.568 0.07798    4.486    4.650
## 9          C     3   3.794 0.07984    3.710    3.878
## 10         D     1   6.601 0.11309    6.483    6.720
## 11         D     2   4.563 0.07348    4.485    4.640
## 12         D     3   3.788 0.08274    3.701    3.875
</pre></div>
<div class="source"><pre class="knitr r">
</pre></div>
</div></div>


<p>It's good practice to start using long data early in your <tt>R</tt> career, as many of the more powerful visuliation and analysis packages require it. With the excellent <tt>ggplot</tt> package, for instance, it is possible to produce complex graphics from long data very simply</p>

<!--<!--begin.rcode,"data_structures-1",fig.width=15,tidy=FALSE,fig.height=10

require(ggplot2)

ggplot(
     oc_data_m,
     aes(
          x = factor(depth),
          y = value,
          group = factor(depth),
          fill = variable
          )
     )+#geom_boxplot(fill="gray")+
     geom_jitter(shape=21,size=3.5,alpha=0.5)+
     facet_grid(variable~treatment,scale="free")+
     theme_bw()+xlab("Sampling Depth")

end.rcode-->

<br><hr class="ex1"><br>

<a class="next" href="scatterplots.html">Next...Scatter-plots</a>

</body>

</html>
