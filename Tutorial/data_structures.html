<html>

<head>
<style type="text/css">
.knitr.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
},
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0em 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage.left {
  text-align: left;
}
.rimage.right {
  text-align: right;
}
.rimage.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>Getting Started with R - Data structures</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css">

</head>

<body>

<h1>Data structures</h1>

<h2>Long and wide data</h2>

<p>The astute among you may have noticed, that although I have recommended that you save your data in 'long' format, all the datasets loaded from R and elsewhere, so far, have been in 'wide' rather than 'long' format.</p>

<p>What exactly do we mean by the terms 'long' and 'wide'? And why does it really matter. To give you an example, we'll simulate some data to practice on. This data consist

<p>In this example we will create our own dataset by randomly generating values along a uniform distribution. We'll use a soil science example. We simulate data for an experiment in whcih 120 samples of bulk density <tt>bd</tt>, and organic carbon <tt>oc</tt> were collected in 3 replicate <tt>blocks</tt>, 4 <tt>treatments</tt>, and at 6 <tt>depths</tt>.</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">1337</span><span class="hl std">)</span>
<span class="hl com"># For brevity the commands have been called lazily!</span>
<span class="hl std">oc_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl std">(</span><span class="hl kwc">block</span> <span class="hl std">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">3</span><span class="hl std">,</span> <span class="hl kwc">each</span> <span class="hl std">=</span> <span class="hl num">40</span><span class="hl std">),</span> <span class="hl kwc">treatment</span> <span class="hl std">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl kwd">rep</span><span class="hl std">(LETTERS[</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">4</span><span class="hl std">],</span>
    <span class="hl kwc">each</span> <span class="hl std">=</span> <span class="hl num">6</span><span class="hl std">),</span> <span class="hl kwc">length.out</span> <span class="hl std">=</span> <span class="hl num">120</span><span class="hl std">),</span> <span class="hl kwc">depth</span> <span class="hl std">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">6</span><span class="hl std">,</span> <span class="hl kwc">each</span> <span class="hl std">=</span> <span class="hl num">20</span><span class="hl std">),</span> <span class="hl kwc">oc</span> <span class="hl std">=</span> <span class="hl kwd">rev</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(</span><span class="hl kwd">abs</span><span class="hl std">(</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">5</span><span class="hl std">,</span>
    <span class="hl num">3</span><span class="hl std">,</span> <span class="hl num">2.2</span><span class="hl std">,</span> <span class="hl num">1.8</span><span class="hl std">,</span> <span class="hl num">1.2</span><span class="hl std">,</span> <span class="hl num">1</span><span class="hl std">)</span> <span class="hl opt">+</span> <span class="hl kwd">runif</span><span class="hl std">(</span><span class="hl num">120</span><span class="hl std">,</span> <span class="hl kwc">min</span> <span class="hl std">=</span> <span class="hl opt">-</span><span class="hl num">1.5</span><span class="hl std">,</span> <span class="hl kwc">max</span> <span class="hl std">=</span> <span class="hl num">1.5</span><span class="hl std">)))),</span> <span class="hl kwc">bd</span> <span class="hl std">=</span> <span class="hl kwd">rev</span><span class="hl std">(</span><span class="hl kwd">sort</span><span class="hl std">(</span><span class="hl kwd">runif</span><span class="hl std">(</span><span class="hl num">120</span><span class="hl std">,</span>
    <span class="hl kwc">min</span> <span class="hl std">=</span> <span class="hl num">0.85</span><span class="hl std">,</span> <span class="hl kwc">max</span> <span class="hl std">=</span> <span class="hl num">1.6</span><span class="hl std">))))</span>
<span class="hl kwd">head</span><span class="hl std">(oc_data)</span>
</pre></div>
<div class="output"><pre class="knitr r">##   block treatment depth    oc    bd
## 1     1         A     1 6.499 1.590
## 2     1         A     1 6.406 1.589
## 3     1         A     1 6.343 1.585
## 4     1         A     1 6.195 1.583
## 5     1         A     1 6.190 1.571
## 6     1         A     1 6.105 1.555
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">str</span><span class="hl std">(oc_data)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	120 obs. of  5 variables:
##  $ block    : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ treatment: Factor w/ 4 levels "A","B","C","D": 1 1 1 1 1 1 2 2 2 2 ...
##  $ depth    : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ oc       : num  6.5 6.41 6.34 6.19 6.19 ...
##  $ bd       : num  1.59 1.59 1.59 1.58 1.57 ...
</pre></div>
</div></div>


<p>This makes for a reasonably complicated factorial experiment. If we want to get somethign sensible from it, we need to convert it to long format first. We use the package <tt>reshape</tt> to do this...</p>

<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">require</span><span class="hl std">(reshape)</span>
<span class="hl com">## oc_data_m &lt;- melt(</span>
<span class="hl com">##      oc_data,</span>
<span class="hl com">##      id.vars = 1:3,</span>
<span class="hl com">##      measure.vars = 4:5</span>
<span class="hl com">##      )</span>
<span class="hl com">## </span>
<span class="hl com">## head(oc_data_m)</span>
<span class="hl com">## </span>
<span class="hl com">## # I won't run this command for brevity, but you should!:</span>
<span class="hl com">## </span>
<span class="hl com">## oc_data_m</span>
<span class="hl com">## </span>
<span class="hl com">## </span>
</pre></div>
</div></div>




</body>

</html>
