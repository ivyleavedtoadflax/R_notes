<html>

<head>
<style type="text/css">
.knitr.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
},
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0em 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage.left {
  text-align: left;
}
.rimage.right {
  text-align: right;
}
.rimage.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>Getting Started with R - R-base graphics</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css">

</head>

<body>

<h1>R-base graphics</h1>

<p>R-base is the basic set of functions that come with R as standard - before you start to download any additional packages. The graphics functions included in R-base are simple, but also highly customisable, and capable of producing high standard, publication quality graphics.</p>

<p>There are other graphics packages which offer more advanced graphical functions like <b>ggplot2</b>, these will not be covered in this course.</p>

<h2>Scatterplots</h2>

<p>The basic plotting functions are very easy, but we first need some data to work with. For this example we are going to use one of the inbuilt datasets in R. There are a number of datasets which come readily loaded with the <tt>datasets</tt> package. In this example we are using the <tt>trees</tt> dataset, which contains 'measurements of the girth, height and volume of timber in 31 felled black cherry trees' (See <tt>?trees</tt> for more information)</p>

<p>First, we will look at the data.</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">trees</span>
</pre></div>
<div class="output"><pre class="knitr r">##    Girth Height Volume
## 1    8.3     70   10.3
## 2    8.6     65   10.3
## 3    8.8     63   10.2
## 4   10.5     72   16.4
## 5   10.7     81   18.8
## 6   10.8     83   19.7
## 7   11.0     66   15.6
## 8   11.0     75   18.2
## 9   11.1     80   22.6
## 10  11.2     75   19.9
## 11  11.3     79   24.2
## 12  11.4     76   21.0
## 13  11.4     76   21.4
## 14  11.7     69   21.3
## 15  12.0     75   19.1
## 16  12.9     74   22.2
## 17  12.9     85   33.8
## 18  13.3     86   27.4
## 19  13.7     71   25.7
## 20  13.8     64   24.9
## 21  14.0     78   34.5
## 22  14.2     80   31.7
## 23  14.5     74   36.3
## 24  16.0     72   38.3
## 25  16.3     77   42.6
## 26  17.3     81   55.4
## 27  17.5     82   55.7
## 28  17.9     80   58.3
## 29  18.0     80   51.5
## 30  18.0     80   51.0
## 31  20.6     87   77.0
</pre></div>
</div></div>


<p>So far so good. To produce a basic scatterplot in R is very simple. We use the <tt>plot</tt> command. In this example, we need to specify which parts of the trees dataset we are going to use. Just as revision, we will try three different ways of doing thise - all will produce the same plot, but each one has a subtly different use.</p>

<p>In the first example, we select a subscript from the dataframe using square brackets <tt>[,1]</tt>. Refer back to <a href="Tutorial/getting_data_into_R.html">Getting data into R</a> if you are unsure. This can be a useful way to select data from a larger dataset, if for instance we are dealing with vectors and matrices. See <a href="Tutorial/data_structures.html">Data structures</a> if you want to read more about these. 

<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">plot</span><span class="hl std">(</span>
     <span class="hl kwc">x</span><span class="hl std">=trees[,</span><span class="hl num">1</span><span class="hl std">],</span>
     <span class="hl kwc">y</span><span class="hl std">=trees[,</span><span class="hl num">2</span><span class="hl std">]</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-2.png" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" class="plot" /></div></div>


<p>The second way, we will use the <tt>$</tt> operator to select a column from within the dataframe:</p>

<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">plot</span><span class="hl std">(</span>
     <span class="hl kwc">x</span><span class="hl std">=trees</span><span class="hl opt">$</span><span class="hl std">Girth,</span>
     <span class="hl kwc">y</span><span class="hl std">=trees</span><span class="hl opt">$</span><span class="hl std">Height</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-3.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" class="plot" /></div></div>


<p>And finally, we can try the <tt>with()</tt> function. Using <tt>with()</tt> dispenses with the need for the <tt>$</tt> operator, and allows us to call objects within a dataframe without specifying the name of the dataframe every time.</p>

<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">trees,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span><span class="hl std">=Girth,</span>
          <span class="hl kwc">y</span><span class="hl std">=Height</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-4.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" class="plot" /></div></div>


<p>It doesn't really matter which method you use in this example, but it is useful to revise different ways of getting at data within a dataframe</p>

<p>This plot is not particularly inspiring, so let's look at some of the ways we can make it nicer.</p>

<p>Within the <tt>plot</tt> command, there are a number of arguments that we can change in order to alter the appearance of the plot, these are listed below, lifted from the help file for <tt>?plot</tt>. You can get a similar list of arguments for any of the other plot functions (or indeed any function) by calling up the help file for that function (just place a "?" in front of the function: e.g. <tt>?boxplot</tt>).</p>


<div style="background-color: lightgray";>
<h4>Arguments</h4>

<table summary="R argblock">
<tr valign="top"><td><code>type</code></td>
<td>
<p>1-character string giving the type of plot desired.  The
following values are possible, for details, see <code>plot</code>:
<code>"p"</code> for points, <code>"l"</code> for lines,
<code>"b"</code> for both points and lines,
<code>"c"</code> for empty points joined by lines,
<code>"o"</code> for overplotted points and lines,
<code>"s"</code> and <code>"S"</code> for stair steps and
<code>"h"</code> for histogram-like vertical lines.  Finally,
<code>"n"</code> does not produce any points or lines.</p>
</td></tr>
<tr valign="top"><td><code>xlim</code></td>
<td>
<p>the x limits (x1, x2) of the plot.  Note that <code>x1 &gt; x2</code>
is allowed and leads to a &lsquo;reversed axis&rsquo;.
</p>
<p>The default value, <code>NULL</code>, indicates that the range of the finite values to be plotted should be used.</p>
</td></tr>
<tr valign="top"><td><code>ylim</code></td>
<td>
<p>the y limits of the plot.</p>
</td></tr>
<tr valign="top"><td><code>log</code></td>
<td>
<p>a character string which contains <code>"x"</code> if the x axis
is to be logarithmic, <code>"y"</code> if the y axis is to be logarithmic
and <code>"xy"</code> or <code>"yx"</code> if both axes are to be logarithmic.</p>
</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
<p>a main title for the plot, see also <code>title</code>.</p>
</td></tr>
<tr valign="top"><td><code>sub</code></td>
<td>
<p>a sub title for the plot.</p>
</td></tr>
<tr valign="top"><td><code>xlab</code></td>
<td>
<p>a label for the x axis, defaults to a description of <code>x</code>.</p>
</td></tr>
<tr valign="top"><td><code>ylab</code></td>
<td>
<p>a label for the y axis, defaults to a description of <code>y</code>.</p>
</td></tr>
<tr valign="top"><td><code>ann</code></td>
<td>
<p>a logical value indicating whether the default annotation
(title and x and y axis labels) should appear on the plot.</p>
</td></tr>
<tr valign="top"><td><code>axes</code></td>
<td>
<p>a logical value indicating whether both axes should be drawn on
the plot.  Use graphical parameter <code>"xaxt"</code> or <code>"yaxt"</code>
to suppress just one of the axes.</p>
</td></tr>
<tr valign="top"><td><code>frame.plot</code></td>
<td>
<p>a logical indicating whether a box should be drawn
around the plot.</p>
</td></tr>
<tr valign="top"><td><code>panel.first</code></td>
<td>
<p>an &lsquo;expression&rsquo; to be evaluated after the
plot axes are set up but before any plotting takes place.  This can
be useful for drawing background grids or scatterplot smooths.  Note
that this works by lazy evaluation: passing this argument from other
<code>plot</code> methods may well not work since it may be evaluated too
early.</p>
</td></tr>
<tr valign="top"><td><code>panel.last</code></td>
<td>
<p>an expression to be evaluated after plotting has
taken place but before the axes, title and box are added.  See the
comments about <code>panel.first</code>.</p>
</td></tr>
<tr valign="top"><td><code>asp</code></td>
<td>
<p>the <i>y/x</i> aspect ratio, see <code>plot.window</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>other graphical parameters (see <code>par</code> and
section &lsquo;Details&rsquo; below).</p>
</td></tr>
</table>
</div>

<h3>Point colour and shape</h3>

<p>So lets change some general things first. We'll label the axes (<tt>xlab</tt> or <tt>ylab</tt>)  and change the shape (<tt>pch</tt>) and colour (<tt>col</tt>) of the points.</p>

<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">trees,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span><span class="hl std">=Girth,</span>
          <span class="hl kwc">y</span><span class="hl std">=Height,</span>
          <span class="hl kwc">xlab</span><span class="hl std">=</span><span class="hl str">&quot;Girth (in)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span><span class="hl std">=</span><span class="hl str">&quot;Height (ft)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">pch</span><span class="hl std">=</span><span class="hl num">16</span><span class="hl std">,</span>
          <span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">&quot;red&quot;</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-5.png" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">
</pre></div>
</div></div>


<br>

<p>A little bit better...</p>

<p>Note that there a wide range of symbol shapes available...</p>

<img src="http://rgraphics.limnology.wisc.edu/images/miscellaneous/pch.png" alt="http://rgraphics.limnology.wisc.edu/images/miscellaneous/pch.png", style="width: 50%;">

<br><br>

<p>...and pretty much any colour you can imagine. Colours can either be specified as a name (e.g. "red"<a href="#footnote-2">[2]</a>, as a hexadecimal code (e.g. <tt>col = "#FF0000"</tt>) or in RGB format (e.g. <tt>col = rgb(1, 0, 0)</tt>). Try <a href="http://www.colorpicker.com/">http://www.colorpicker.com</a>) if you get stuck. Note that unless you are going topay for colour figures in journal plates, or you can be sure that no colour blind people will read your work, it is good practice to use a combination of colours and symbols</p>

<p>We can use the package <tt>RColorBrewer</tt> to make picking complementary colour palettes a little easier. See <tt>?RColorBrewer</tt> or <a href="http://colorbrewer2.org">http://colorbrewer2.org</a> for more information. There are a number of palettes for different applications. We will just use the first of them - this palette is good for colouring lines and points, but should be avoided for blocks of colour.</p>


<div class="chunk" id="unnamed-chunk-6"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span>
     <span class="hl str">&quot;RColorBrewer&quot;</span><span class="hl std">,</span>
     <span class="hl kwc">repos</span> <span class="hl std">=</span> <span class="hl str">&quot;http://cran.rstudio.com/&quot;</span>
     <span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into 'C:/Users/s162906/Documents/R/win-library/3.0'
## (as 'lib' is unspecified)
</pre></div>
<div class="output"><pre class="knitr r">## package 'RColorBrewer' successfully unpacked and MD5 sums checked
## 
## The downloaded binary packages are in
## 	C:\Users\s162906\AppData\Local\Temp\Rtmp0Gq2nP\downloaded_packages
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(RColorBrewer)</span>
</pre></div>
</div></div>


<p>We can see the various palettes with:</p>

<div class="chunk" id="unnamed-chunk-7"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">display.brewer.pal</span><span class="hl std">(</span>
     <span class="hl kwc">n</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">,</span>
     <span class="hl kwc">name</span><span class="hl std">=</span><span class="hl str">&quot;Set1&quot;</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-7.png" title="plot of chunk unnamed-chunk-7" alt="plot of chunk unnamed-chunk-7" class="plot" /></div></div>


<p>And create our palette with:</p>

<div class="chunk" id="unnamed-chunk-8"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">pal</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">brewer.pal</span><span class="hl std">(</span>
     <span class="hl kwc">n</span><span class="hl std">=</span><span class="hl num">9</span><span class="hl std">,</span>
     <span class="hl kwc">name</span><span class="hl std">=</span><span class="hl str">&quot;Set1&quot;</span>
     <span class="hl std">)</span>
</pre></div>
</div></div>


<p>Note that <tt>RColorBrewer</tt> specifies colours with hexadecimals:</p>

<div class="chunk" id="unnamed-chunk-9"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">pal</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] "#E41A1C" "#377EB8" "#4DAF4A" "#984EA3" "#FF7F00" "#FFFF33" "#A65628"
## [8] "#F781BF" "#999999"
</pre></div>
</div></div>


<h3>Axes and outlines</h3>

<p>We are also able to customise the axes in any way we want, but it is usually necessary to remove the axes altogether with <tt>xaxt="n"</tt> and/or <tt>yaxt="n"</tt> and replace them with the <tt>axis</tt> command.</p>

<p>This example also demonstrates the use of the <tt>bty</tt> argument.</p>

<div class="chunk" id="unnamed-chunk-10"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">trees,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span><span class="hl std">=Girth,</span>
          <span class="hl kwc">y</span><span class="hl std">=Height,</span>
          <span class="hl kwc">xlab</span><span class="hl std">=</span><span class="hl str">&quot;Girth (in)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span><span class="hl std">=</span><span class="hl str">&quot;Height (ft)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">pch</span><span class="hl std">=</span><span class="hl num">16</span><span class="hl std">,</span>
          <span class="hl kwc">col</span><span class="hl std">=pal[</span><span class="hl num">2</span><span class="hl std">],</span>         <span class="hl com"># second colour from the palette we produced.</span>
          <span class="hl kwc">yaxt</span><span class="hl std">=</span><span class="hl str">&quot;n&quot;</span><span class="hl std">,</span>           <span class="hl com"># remove the y axis</span>
          <span class="hl kwc">xaxt</span><span class="hl std">=</span><span class="hl str">&quot;n&quot;</span><span class="hl std">,</span>           <span class="hl com"># remove the y axis</span>
          <span class="hl kwc">cex.lab</span> <span class="hl std">=</span> <span class="hl num">1.2</span><span class="hl std">,</span>      <span class="hl com"># scaling factor relating to the size of axis titles.</span>
          <span class="hl kwc">cex</span> <span class="hl std">=</span> <span class="hl num">1.4</span><span class="hl std">,</span>          <span class="hl com"># scaling factor for the size of points</span>
          <span class="hl kwc">bty</span><span class="hl std">=</span><span class="hl str">&quot;l&quot;</span>             <span class="hl com"># this can be either &quot;o&quot;, &quot;l&quot; or &quot;u&quot;</span>
          <span class="hl std">)</span>                   <span class="hl com"># and affects the box bordering the plot</span>
     <span class="hl std">)</span>
<span class="hl kwd">axis</span><span class="hl std">(</span>
     <span class="hl kwc">side</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span>           <span class="hl com"># 1=below, 2=left, 3=above and 4=right.</span>
     <span class="hl kwc">at</span> <span class="hl std">=</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">20</span><span class="hl std">,</span><span class="hl num">4</span><span class="hl std">),</span>   <span class="hl com"># a sequence denoting the location of axis tick marks</span>
     <span class="hl kwc">cex.axis</span> <span class="hl std">=</span> <span class="hl num">1.2</span>      <span class="hl com"># a scaling factor of the default text size</span>
     <span class="hl std">)</span>
<span class="hl kwd">axis</span><span class="hl std">(</span>
     <span class="hl kwc">side</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>
     <span class="hl kwc">at</span> <span class="hl std">=</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">50</span><span class="hl std">,</span><span class="hl num">100</span><span class="hl std">,</span><span class="hl num">5</span><span class="hl std">),</span>
     <span class="hl kwc">las</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>            <span class="hl com"># Rotate axis labels</span>
     <span class="hl kwc">cex.axis</span><span class="hl std">=</span><span class="hl num">1.2</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-10.png" title="plot of chunk unnamed-chunk-10" alt="plot of chunk unnamed-chunk-10" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">
</pre></div>
</div></div>


<h3>Additional observations</h3>

<p>If we want to add additional observations to a plot, it is quite simple. We can use the <tt>points</tt> command, which is specified in a very similar way to the original <tt>plot</tt> command.</p>

<p>In this example, we will use the same <tt>trees</tt> dataset and plot as the previous example, but we will add a second set of observations which we have simulated using <tt>jitter</tt>. The <tt>jitter</tt> command adds a small amount of 'noise' to an observation by adding or removing a small amount from it.</p>

<div class="chunk" id="unnamed-chunk-11"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># Repeat the same code as the last example:</span>
<span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">trees,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">= Girth,</span>
          <span class="hl kwc">y</span> <span class="hl std">= Height,</span>
          <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Girth (in)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;Height (ft)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">pch</span> <span class="hl std">=</span> <span class="hl num">16</span><span class="hl std">,</span>
          <span class="hl kwc">col</span> <span class="hl std">= pal[</span><span class="hl num">2</span><span class="hl std">],</span>         <span class="hl com"># second colour from the palette we produced.</span>
          <span class="hl kwc">yaxt</span> <span class="hl std">=</span> <span class="hl str">&quot;n&quot;</span><span class="hl std">,</span>           <span class="hl com"># remove the y axis</span>
          <span class="hl kwc">xaxt</span> <span class="hl std">=</span> <span class="hl str">&quot;n&quot;</span><span class="hl std">,</span>           <span class="hl com"># remove the y axis</span>
          <span class="hl kwc">cex.lab</span> <span class="hl std">=</span> <span class="hl num">1.2</span><span class="hl std">,</span>      <span class="hl com"># scaling factor relating to the size of axis titles.</span>
          <span class="hl kwc">cex</span> <span class="hl std">=</span> <span class="hl num">1.4</span><span class="hl std">,</span>          <span class="hl com"># scaling factor for the size of points</span>
          <span class="hl kwc">bty</span> <span class="hl std">=</span> <span class="hl str">&quot;l&quot;</span>             <span class="hl com"># this can be either &quot;o&quot;, &quot;l&quot; or &quot;u&quot;</span>
          <span class="hl std">)</span>                   <span class="hl com"># and affects the box bordering the plot</span>
     <span class="hl std">)</span>
<span class="hl kwd">axis</span><span class="hl std">(</span>
     <span class="hl kwc">side</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span>           <span class="hl com"># 1=below, 2=left, 3=above and 4=right.</span>
     <span class="hl kwc">at</span> <span class="hl std">=</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">20</span><span class="hl std">,</span><span class="hl num">4</span><span class="hl std">),</span>   <span class="hl com"># a sequence denoting the location of axis tick marks</span>
     <span class="hl kwc">cex.axis</span> <span class="hl std">=</span> <span class="hl num">1.2</span>      <span class="hl com"># a scaling factor of the default text size</span>
     <span class="hl std">)</span>
<span class="hl kwd">axis</span><span class="hl std">(</span>
     <span class="hl kwc">side</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>
     <span class="hl kwc">at</span> <span class="hl std">=</span> <span class="hl kwd">seq</span><span class="hl std">(</span><span class="hl num">50</span><span class="hl std">,</span><span class="hl num">100</span><span class="hl std">,</span><span class="hl num">5</span><span class="hl std">),</span>
     <span class="hl kwc">las</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>            <span class="hl com"># Rotate axis labels</span>
     <span class="hl kwc">cex.axis</span> <span class="hl std">=</span> <span class="hl num">1.2</span>
     <span class="hl std">)</span>
<span class="hl com"># Add an additonal set of points:</span>
<span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">trees,</span>
     <span class="hl kwd">points</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">=</span> <span class="hl kwd">jitter</span><span class="hl std">(Girth,</span> <span class="hl kwc">amount</span><span class="hl std">=</span><span class="hl num">2</span><span class="hl std">),</span>       <span class="hl com"># See ?jitter for details</span>
          <span class="hl kwc">y</span> <span class="hl std">=</span> <span class="hl kwd">jitter</span><span class="hl std">(Height,</span> <span class="hl kwc">amount</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">),</span>
          <span class="hl kwc">pch</span> <span class="hl std">=</span> <span class="hl num">15</span><span class="hl std">,</span>
          <span class="hl kwc">col</span> <span class="hl std">= pal[</span><span class="hl num">1</span><span class="hl std">],</span>
          <span class="hl kwc">cex</span> <span class="hl std">=</span> <span class="hl num">1.4</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
<span class="hl com"># We also now need to add a legend:</span>
<span class="hl kwd">legend</span><span class="hl std">(</span>
     <span class="hl str">&quot;bottomright&quot;</span><span class="hl std">,</span>      <span class="hl com"># this can also take the form of x and y coordinates</span>
     <span class="hl kwc">legend</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Jittered&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Original&quot;</span><span class="hl std">),</span> <span class="hl com"># labels for the legend</span>
     <span class="hl kwc">col</span> <span class="hl std">= pal[</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">2</span><span class="hl std">],</span>     <span class="hl com"># colour in order of appearance</span>
     <span class="hl kwc">pch</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">15</span><span class="hl opt">:</span><span class="hl num">16</span><span class="hl std">),</span>     <span class="hl com"># pch in order of appearance</span>
     <span class="hl kwc">pt.cex</span> <span class="hl std">=</span> <span class="hl num">1.4</span><span class="hl std">,</span>       <span class="hl com"># size of legend points</span>
     <span class="hl kwc">bty</span><span class="hl std">=</span><span class="hl str">&quot;n&quot;</span>             <span class="hl com"># remove the black outline from the legend</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-11.png" title="plot of chunk unnamed-chunk-11" alt="plot of chunk unnamed-chunk-11" class="plot" /></div></div>


<p>Note that in the above example we would need to adjust the limits of the x and y axes in order to accomodate all of the extra points which we added. This can be done with the arguments <tt>xlim=c(1,2)</tt> or <tt>ylim=c(1,2)</tt>, substituting the lowest and highest numbers for the 1 and 2.</p>

<p>It's very easy to add an additional axis in R, in case you want to plot two variables against each other. The axis itself can be added with an <tt>axis</tt> command, but getting R to plot a second variable with a different axis scale is a little more difficult.</p>


<h3>Log transformations</h3>

<p></p>

<p>As before, we import directly from an online text file</p>

<div class="chunk" id="unnamed-chunk-12"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">sapdecay</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.table</span><span class="hl std">(</span>
     <span class="hl str">&quot;http://www.bio.ic.ac.uk/research/mjcraw/therbook/data/sapdecay.txt&quot;</span><span class="hl std">,</span>
     <span class="hl kwc">header</span><span class="hl std">=T</span>
     <span class="hl std">)</span>
<span class="hl kwd">plot</span><span class="hl std">(sapdecay</span><span class="hl opt">$</span><span class="hl std">y,sapdecay</span><span class="hl opt">$</span><span class="hl std">x,</span><span class="hl kwc">log</span><span class="hl std">=</span><span class="hl str">&quot;x&quot;</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-12.png" title="plot of chunk unnamed-chunk-12" alt="plot of chunk unnamed-chunk-12" class="plot" /></div></div>


<p> We'll call the data to examine it. Note this data is dealt with on p70 of 'The R Book'. remember that typing the name of the object <tt>sapdecay</tt> is the 'short-hand' equivalent of typing <tt>print(sapdecay)</tt> - there are certain occasions when it will be necessary to use the full command - more of that later.</p>

<div class="chunk" id="unnamed-chunk-13"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">sapdecay</span>
</pre></div>
<div class="output"><pre class="knitr r">##     x       y
## 1   0 1.00000
## 2   2 0.96024
## 3   4 0.84466
## 4   6 0.70694
## 5   8 0.70864
## 6  10 0.60980
## 7  12 0.51325
## 8  14 0.47140
## 9  16 0.38408
## 10 18 0.37228
## 11 20 0.33409
## 12 22 0.27331
## 13 24 0.25162
## 14 26 0.22279
## 15 28 0.21022
## 16 30 0.19059
## 17 32 0.16691
## 18 34 0.14073
## 19 36 0.12029
## 20 38 0.11646
## 21 40 0.09274
## 22 42 0.08397
## 23 44 0.08829
## 24 46 0.07179
## 25 48 0.05933
## 26 50 0.06171
</pre></div>
</div></div>


<p>So, we have two columns of data, which we will plot against each other - this is very simple</p>

<div class="chunk" id="unnamed-chunk-14"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">plot</span><span class="hl std">(sapdecay)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-14.png" title="plot of chunk unnamed-chunk-14" alt="plot of chunk unnamed-chunk-14" class="plot" /></div></div>


<p>In this example, R recognises that there are two columns in the object sapdecay, and it simply plots them against each other. This kind of command is called a lazy command, because we have not specified any of the arguments explicitly.</p>

<p>The long version would be:</p>

<div class="chunk" id="unnamed-chunk-15"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">plot</span><span class="hl std">(</span>
     <span class="hl kwc">x</span> <span class="hl std">= sapdecay</span><span class="hl opt">$</span><span class="hl std">x,</span>
     <span class="hl kwc">y</span> <span class="hl std">= sapdecay</span><span class="hl opt">$</span><span class="hl std">y</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-15.png" title="plot of chunk unnamed-chunk-15" alt="plot of chunk unnamed-chunk-15" class="plot" /></div></div>


<p> Note that we can also dispence with the sapdecay$ by using the with() command:</p>

<div class="chunk" id="unnamed-chunk-16"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">sapdecay,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">= x,</span>
          <span class="hl kwc">y</span> <span class="hl std">= y</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-16.png" title="plot of chunk unnamed-chunk-16" alt="plot of chunk unnamed-chunk-16" class="plot" /></div></div>


<p>This isn't a particularly inspiring plot, so let's make it look a little better...</p>

<p>First let's make it a little easier to see al the changes that we are making</p>

<div class="chunk" id="unnamed-chunk-17"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com"># First let's make it a little easier to see al the changes that we are making</span>
<span class="hl kwd">par</span><span class="hl std">(</span><span class="hl kwc">mfrow</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">))</span>
<span class="hl com"># This command splits the plotting area into four, so we can see four plots side</span>
<span class="hl com"># by side. We'll cover the par command in more detail in the next section. We</span>
<span class="hl com"># then simply make four plots, one after the other, and they will fill up the</span>
<span class="hl com"># plotting area.</span>
<span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">sapdecay,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">= x,</span>
          <span class="hl kwc">y</span> <span class="hl std">= y,</span>
          <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Time (hours)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;Decay rate&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;l&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl str">&quot;red&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">lwd</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>
          <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;Line&quot;</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
<span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">sapdecay,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">= x,</span>
          <span class="hl kwc">y</span> <span class="hl std">= y,</span>
          <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Time (hours)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;Decay rate&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;o&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl str">&quot;green&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">lwd</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span>
          <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;Overplot&quot;</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
<span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">sapdecay,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">= x,</span>
          <span class="hl kwc">y</span> <span class="hl std">= y,</span>
          <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Time (hours)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;Decay rate&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;h&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl str">&quot;blue&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">lwd</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>
          <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;Histogram&quot;</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
<span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">sapdecay,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">= x,</span>
          <span class="hl kwc">y</span> <span class="hl std">= y,</span>
          <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Time (hours)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;Decay rate&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;s&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl str">&quot;hotpink&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">lwd</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>
          <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;Step&quot;</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-17.png" title="plot of chunk unnamed-chunk-17" alt="plot of chunk unnamed-chunk-17" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># It's important that we reset the mfrow parameter at the end of plotting,</span>
<span class="hl com"># otherwise all subsequent plots will apear on this four by four grid, which may</span>
<span class="hl com"># not be what we want.</span>
<span class="hl kwd">par</span><span class="hl std">(</span><span class="hl kwc">mfrow</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">))</span>
</pre></div>
</div></div>


<p>Using this method, it's also perfectly possible to combine plots of two different types, and plot them next to each other.</p>

<p>Let's imagine that we want to test whether a variable is normally distributed - there are two very simple graphical commands built into R that make this easier: <tt>qqnorm</tt> and <tt>qqplot</tt>. These commands produce quantile-quantile plots for the normal distribution. Essentially if the data are normally distributed, they will conform to the straight line<a href="#footnote-1">[1]</a>.</p>

<p>First we will create a vector of random numbers drawn from a normal distribution - so we already know that they are normal!</p>

<div class="chunk" id="unnamed-chunk-18"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">normal_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rnorm</span><span class="hl std">(</span>
     <span class="hl num">100</span><span class="hl std">,</span>
     <span class="hl kwc">mean</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span>
     <span class="hl kwc">sd</span><span class="hl std">=</span><span class="hl num">1</span>
     <span class="hl std">)</span>
<span class="hl std">normal_data</span>
</pre></div>
<div class="output"><pre class="knitr r">##   [1] -0.427834  0.952379 -0.356598  1.533801  0.239743  0.005887  1.035245
##   [8]  0.173868 -0.576987  0.777272 -0.011809  0.715752  0.938410  0.679495
##  [15] -0.183939  0.743440 -0.416446 -0.694505  1.628829  1.050134  1.222321
##  [22]  0.578370  2.384393 -1.132673  1.123094 -0.058520 -0.177078  0.760425
##  [29] -1.365887  0.411815  0.115403  0.961482 -1.005315 -0.988228  0.652005
##  [36]  0.630295  0.490168  0.094490  0.034675  0.063789 -0.316461  0.890098
##  [43]  0.414281 -0.032136  0.161321  2.629264 -0.025494 -0.691093 -0.008445
##  [50] -0.551786 -2.251104  1.013184 -0.836920 -0.248196 -1.600464 -0.347562
##  [57]  0.338513 -0.870481  0.495192 -0.027066  1.570640  1.027378  0.482680
##  [64] -0.033636 -0.223927  0.127711  2.096438 -0.996613  1.277723 -0.871198
##  [71] -1.437580 -0.051511  1.884303 -0.191838  0.684206 -0.383205  1.417015
##  [78] -1.538563  0.501695 -2.204715  0.151193 -1.416295 -0.114876  0.030229
##  [85]  1.547652  1.099249  0.321787  0.818820  1.934744 -0.192334 -0.170058
##  [92] -0.784289 -1.697530 -0.200420  1.781663 -0.525797 -0.003384  1.618810
##  [99] -0.721045 -0.161961
</pre></div>
</div></div>


<p>And now...some plots. First, two plots side by side.</p>

<div class="chunk" id="unnamed-chunk-19"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">par</span><span class="hl std">(</span>
     <span class="hl kwc">mfrow</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">)</span>
     <span class="hl std">)</span>
<span class="hl com"># Remember that the first number is the number of rows, the latter is the number</span>
<span class="hl com"># of columns. So here, we have specified one row, two columns...</span>
<span class="hl com"># Now the plots:</span>
<span class="hl kwd">hist</span><span class="hl std">(normal_data)</span>
<span class="hl kwd">qqnorm</span><span class="hl std">(normal_data)</span>
<span class="hl kwd">qqline</span><span class="hl std">(normal_data)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-19.png" title="plot of chunk unnamed-chunk-19" alt="plot of chunk unnamed-chunk-19" class="plot" /></div></div>


<p>So things should look pretty normal. In this example we have not specified a 'seed' (see <tt>?set.seed</tt> for more info). So every time that you run the code, you will get a different set of randomly generated numbers drawn from a normal distribution.</p>

<p>All well and good, but what about one above the other? Just changed the one and 2 around in the <tt>par(mfrow=c(x,y))</tt> command.</p>

<div class="chunk" id="unnamed-chunk-20"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">par</span><span class="hl std">(</span><span class="hl kwc">mfrow</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">))</span>
<span class="hl com"># Remember that the first number is the number of rows, the latter is the number</span>
<span class="hl com"># of columns. So here, we have specified one row, two columns...</span>
<span class="hl com"># Now the plots:</span>
<span class="hl kwd">hist</span><span class="hl std">(normal_data)</span>
<span class="hl kwd">qqnorm</span><span class="hl std">(normal_data)</span>
<span class="hl kwd">qqline</span><span class="hl std">(normal_data)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-20.png" title="plot of chunk unnamed-chunk-20" alt="plot of chunk unnamed-chunk-20" class="plot" /></div></div>


<h2>Scatterplots</h2>

<p>Now let's look in more detail at scatterplots, and some of the functions we can use to customise them, in order to build publication quality plots.</p>


<h2>Customising your plots</h2>

<p>There are a number of arguments that can be passed to the plot commands in order to customise your plots. The below list is lifted from the help file for the <tt>?plot.default</tt> command. You can normally get similar lists of possible arguments for other commands: e.g. <tt>?hist</tt>.</p>




<div class="ex">

<h2>Exercise</h2>

<p>Try customising some of the previous plots by altering some of these arguments for yourself...</p>

<p>Below is a plot produced using the <tt>sapdecay</tt> vector we produced earlier. See if you can reproduce it by changing the arguments listed above.</p>

</div>

<div class="chunk" id="unnamed-chunk-21"><div class="rimage default"><img src="figure/unnamed-chunk-21.png" title="plot of chunk unnamed-chunk-21" alt="plot of chunk unnamed-chunk-21" class="plot" /></div></div>




<br><br>
<hr>

<p id="footnote-1">[1] I'm not going to dwell on the reasons why this is so - we're more interested in the plotting graphs than the statistics behind it in this sections, but if you don't understand what is going on here, you should look it! <a href="http://en.wikipedia.org/wiki/Q%E2%80%93Q_plot">http://en.wikipedia.org/wiki/Q-Q_plot</a>.</p>

<div id="footnote-2">[2]<br><img src="http://sape.inf.usi.ch/sites/default/files/ggplot2-colour-names.png" alt="http://sape.inf.usi.ch/sites/default/files/ggplot2-colour-names.png"></div>




</body>

</html>
