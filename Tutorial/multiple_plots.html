<html>

<head>
<style type="text/css">
.knitr.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
},
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0em 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage.left {
  text-align: left;
}
.rimage.right {
  text-align: right;
}
.rimage.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>Getting Started with R - Multiple Plots</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css">


</head>

<body>

<table align="center" style="width:80%;">
<tr>
<td class="next"><a href="histograms.html">Previous</a></td>
<td class="next"><a href="index.html">Course Overview</a></td>
<td class="next"><a href="t-test.html">Next</a></td>
</tr>
</table>

<br><hr class="ex1"><br>

<h1>Multiple plots</h1>




<p>You may have noticed in one of the previous examples, that two plots were produced one on top of the other. This is a pretty easy thing to accomplish.</p>

<p>All we need to do is split the plotting area with the <tt>par(mfrow=c(x,y))</tt> command. As with subscripts, with this command <tt>x</tt> codes for the number of rows, and <tt>y</tt> represents the number of columns. Check <tt>?par</tt> for more information.</p>


<div class="chunk" id="multiple_plots-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">par</span><span class="hl std">(</span><span class="hl kwc">mfrow</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">))</span>
<span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">sapdecay,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">= x,</span>
          <span class="hl kwc">y</span> <span class="hl std">= y,</span>
          <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Time (hours)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;Decay rate&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;l&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl str">&quot;red&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">lwd</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>
          <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;Line&quot;</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
<span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">sapdecay,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">= x,</span>
          <span class="hl kwc">y</span> <span class="hl std">= y,</span>
          <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Time (hours)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;Decay rate&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;o&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl str">&quot;green&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">lwd</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span>
          <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;Overplot&quot;</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
<span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">sapdecay,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">= x,</span>
          <span class="hl kwc">y</span> <span class="hl std">= y,</span>
          <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Time (hours)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;Decay rate&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;h&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl str">&quot;blue&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">lwd</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>
          <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;Histogram&quot;</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
<span class="hl kwd">with</span><span class="hl std">(</span>
     <span class="hl std">sapdecay,</span>
     <span class="hl kwd">plot</span><span class="hl std">(</span>
          <span class="hl kwc">x</span> <span class="hl std">= x,</span>
          <span class="hl kwc">y</span> <span class="hl std">= y,</span>
          <span class="hl kwc">xlab</span> <span class="hl std">=</span> <span class="hl str">&quot;Time (hours)&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">ylab</span> <span class="hl std">=</span> <span class="hl str">&quot;Decay rate&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;s&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl str">&quot;hotpink&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">lwd</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">,</span>
          <span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">&quot;Step&quot;</span>
          <span class="hl std">)</span>
     <span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/multiple_plots-1.png" title="plot of chunk multiple_plots-1" alt="plot of chunk multiple_plots-1" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># It's important that we reset the mfrow parameter at the end of plotting, </span>
<span class="hl com"># otherwise all subsequent plots will appear on this four by four grid, which</span>
<span class="hl com"># may not be what we want.</span>
<span class="hl kwd">par</span><span class="hl std">(</span><span class="hl kwc">mfrow</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">))</span>
</pre></div>
</div></div>


<p>Using this method, it's also perfectly possible to combine plots of two different types, and plot them next to each other.</p>

<p>Let's imagine that we want to test whether a variable is normally distributed - there are two very simple graphical commands built into R that make this easier: <tt>qqnorm</tt> and <tt>qqline</tt>. These commands produce quantile-quantile plots for the normal distribution. Essentially if the data are normally distributed, they will conform to the straight line<a href="#footnote-1">[1]</a>.</p>

<p>First we will create a vector of random numbers drawn from a normal distribution - so we already know that they are normal!</p>

<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl std">normal_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rnorm</span><span class="hl std">(</span>
     <span class="hl num">100</span><span class="hl std">,</span>
     <span class="hl kwc">mean</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span>
     <span class="hl kwc">sd</span><span class="hl std">=</span><span class="hl num">1</span>
     <span class="hl std">)</span>
<span class="hl std">normal_data</span>
</pre></div>
<div class="output"><pre class="knitr r">##   [1]  0.19249 -1.44670 -0.32318  1.62230 -0.68902  2.04212  0.94378
##   [8]  2.08193  1.91712 -0.41481  1.03285 -1.67857  0.15755  1.48914
##  [15] -0.07579  1.27178  0.64167  0.80076  1.86266 -0.54536  0.61928
##  [22]  0.12264 -0.79098 -0.49977 -1.63515  1.78457  0.29888  0.75250
##  [29] -1.07460  0.06427  1.26265  1.09995 -1.12356  3.44608 -0.71972
##  [36] -0.32685 -0.52977  0.52415 -1.07961 -0.05511  2.19868 -1.77391
##  [43]  0.06503  0.65497 -0.71287  1.02057  0.63161  0.44743  0.46654
##  [50] -0.69826 -0.03645  1.11797 -0.70008 -1.12405 -0.61307  1.01244
##  [57] -2.34387  0.59026  0.31913  0.70161 -1.37746  0.31265  1.12085
##  [64]  0.47183  1.12769  0.67772  1.51024  2.06103 -0.65032 -1.32424
##  [71]  0.65947 -0.22143 -0.96216  0.18746  0.01224  0.71228 -0.75373
##  [78]  0.03819  1.17842 -0.15320 -0.16170  1.46026  2.00946 -0.07794
##  [85]  1.35434 -1.02718 -1.04118 -0.87062  0.85313 -0.62276  1.21571
##  [92] -1.62141 -0.06858 -0.06298  1.07571  1.12910  0.45015  0.05059
##  [99] -0.12433  0.91201
</pre></div>
</div></div>


<p>And now...some plots. First, two plots side by side.</p>

<div class="chunk" id="multiple_plots-2"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">par</span><span class="hl std">(</span>
     <span class="hl kwc">mfrow</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">)</span>
     <span class="hl std">)</span>
<span class="hl com"># Remember that the first number is the number of rows, the latter is the number</span>
<span class="hl com"># of columns. So here, we have specified one row, two columns...</span>
<span class="hl com"># Now the plots:</span>
<span class="hl kwd">hist</span><span class="hl std">(normal_data)</span>
<span class="hl kwd">qqnorm</span><span class="hl std">(normal_data)</span>
<span class="hl kwd">qqline</span><span class="hl std">(normal_data)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/multiple_plots-2.png" title="plot of chunk multiple_plots-2" alt="plot of chunk multiple_plots-2" class="plot" /></div></div>


<p>So things should look pretty normal. In this example we have not specified a 'seed' (see <tt>?set.seed</tt> for more info). So every time that you run the code, you will get a different set of randomly generated numbers drawn from a normal distribution.</p>

<p>All well and good, but what about one above the other? Just changed the 1 and 2 around in the <tt>par(mfrow=c(x,y))</tt> command.</p>

<div class="chunk" id="multiple_plots-3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">par</span><span class="hl std">(</span><span class="hl kwc">mfrow</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">))</span>
<span class="hl com"># Remember that the first number is the number of rows, the latter is the number</span>
<span class="hl com"># of columns. So here, we have specified one row, two columns...</span>
<span class="hl com"># Now the plots:</span>
<span class="hl kwd">hist</span><span class="hl std">(normal_data)</span>
<span class="hl kwd">qqnorm</span><span class="hl std">(normal_data)</span>
<span class="hl kwd">qqline</span><span class="hl std">(normal_data)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/multiple_plots-3.png" title="plot of chunk multiple_plots-3" alt="plot of chunk multiple_plots-3" class="plot" /></div></div>


<br>

<div class="ex">

<h3>Exercise</h3>

<p>Using what you have learnt in the previous sections, and the data from the <tt>car_prices</tt>, have a go at reproducing the plots you see below. Most of what you need to know has been covered, though you will need to consult the help files for certain commands.</p>
</div>

<br><br><br>

<div class="chunk" id="multiple_plots-4"><div class="rimage default"><img src="figure/multiple_plots-4.png" title="plot of chunk multiple_plots-4" alt="plot of chunk multiple_plots-4" class="plot" /></div></div>


<br><br><hr>

<p id="footnote-1">[1] I'm not going to dwell on the reasons why this is so - we're more interested in the plotting graphs than the statistics behind it in this sections, but if you don't understand what is going on here, you should look it up! <a href="http://en.wikipedia.org/wiki/Q%E2%80%93Q_plot">http://en.wikipedia.org/wiki/Q-Q_plot</a>.</p>

<br><hr class="ex1"><br>

<table align="center" style="width:80%;">
<tr>
<td class="next"><a href="histograms.html">Previous</a></td>
<td class="next"><a href="index.html">Course Overview</a></td>
<td class="next"><a href="t-test.html">Next</a></td>
</tr>
</table>

</body>
</html>
