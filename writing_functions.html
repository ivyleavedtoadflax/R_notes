<html>

<head>
<style type="text/css">.knitr.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
},
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0em 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.rimage.left {
  text-align: left;
}
.rimage.right {
  text-align: right;
}
.rimage.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}</style>
<title>Writing functions</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css">
</head>

<body>

<h1>Writing functions</h1>

<p>One of the great strengths of R, is that at its heart, it is a programming language, and hence has all the usual functionality one might expect from a programming language. This incldues teh ability to write functions.</p>

<p>This can be extremely useful when it comes to repetitive tasks that we have to complete time and time again. You might for example, write a function to correctly format data arriving in a raw state, for example from weather stations or from lab equipment. You might also want to complete exactly the same analysis on many subsets of a large dataset; this can easily be handled by a function or loop.</p>

<h2>IF,IF ELSE, and FOR</h2>

<p>Let's start with something that many Excel users will be familiar with - the IF function.</p>

<p>If you have ever done any coding in Excel, you will probably have come across the IF() command. This command takes the form of: <b>IF(logical_test,[value_if_true],[value_if_false])</b>. The astute among you will realise that this is in effect an IF ELSE statement! An example of its usage might be:</p>

<p><b>=IF(A1>5,TRUE,FALSE)</b></p>

<p>I.e: if the value in cell A1 is greater than 5, the value in the current cell should be TRUE, and if not, the value should be FALSE - simple enough.</p>

<p>Let's try something similar in R. In R the <b>if</b> command is composed of just two elements the logical_test, as Excel calls it (more correctly, the "condition"), and the value_if_true (or the "consequent"). The syntax looks like this: <b>if (condition) {consequent}</b>.</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r">
x &lt;- 9  <span class="hl com"># define object x with the value 5</span>

<span class="hl com"># try out the <span class="hl kwa">if</span> statement:</span>

<span class="hl kwd"><span class="hl kwa">if</span></span> (x &gt; 5) {
    <span class="hl kwd">print</span>(<span class="hl kwa">TRUE</span>)
}
</pre></div>
<div class="output"><pre class="knitr r">## [1] TRUE
</pre></div>
</div></div>


<p>So far so good...and if we want to do exactly the same thing as we did in Excel we need to add <b>else</b>.</p>

<div class="chunk" id="unnamed-chunk-2"><div class="rcode"><div class="source"><pre class="knitr r">
<span class="hl kwd"><span class="hl kwa">if</span></span> (x &gt; 5) {
    <span class="hl kwd">print</span>(<span class="hl kwa">TRUE</span>)
} <span class="hl kwa">else</span> {
    <span class="hl com"># note that it is important that the <span class="hl kwa">else</span> is on the same line as the closed curly bracket</span>
    <span class="hl kwd">print</span>(<span class="hl kwa">FALSE</span>)
}
</pre></div>
<div class="output"><pre class="knitr r">## [1] TRUE
</pre></div>
<div class="source"><pre class="knitr r">
</pre></div>
</div></div>


<p>Something to note from this is example is that R recognises <b>TRUE</b> and <b>FALSE</b> as booleans, hence you don't need to use quotes. If you wanted to use a character string, you would definitely need to use quotes.</p>


<h3>For loops</h3>

<p><b>For</b> loops are used when you need to perform the same action many times, but taking different inputs each time. You could, for instance, run the same statistical test on a several different sets of data. The example below shows a simple for loop.</p>

<div class="chunk" id="unnamed-chunk-3"><div class="rcode"><div class="source"><pre class="knitr r">
<span class="hl com"># In specifying a <span class="hl kwa">for</span> loop, we must define the range over which we want</span>
<span class="hl com"># the loop to run.  In this case we use 1:10. The loop will then iterate</span>
<span class="hl com"># across the sequence 1, 2, 3...etc substituting i <span class="hl kwa">for</span> the number of the</span>
<span class="hl com"># iteration</span>

<span class="hl kwd"><span class="hl kwa">for</span></span> (i <span class="hl kwa">in</span> 1:10) {
    <span class="hl kwd">print</span>(<span class="hl kwd">paste</span>(<span class="hl str">"This is iteration number"</span>, i, sep = <span class="hl str">" "</span>))
}
</pre></div>
<div class="output"><pre class="knitr r">## [1] "This is iteration number 1"
## [1] "This is iteration number 2"
## [1] "This is iteration number 3"
## [1] "This is iteration number 4"
## [1] "This is iteration number 5"
## [1] "This is iteration number 6"
## [1] "This is iteration number 7"
## [1] "This is iteration number 8"
## [1] "This is iteration number 9"
## [1] "This is iteration number 10"
</pre></div>
<div class="source"><pre class="knitr r">
</pre></div>
</div></div>


<h2>Real world example</h2>

<p>Now we will combine an <b>if else</b>, statement and a <b>for</b> loop in order to demonstarte the power of these tools.</p>


<div class="chunk" id="unnamed-chunk-4"><div class="rcode"><div class="source"><pre class="knitr r">
<span class="hl com"># First generate 100 random numbers using a normal distribution using rnorm - see ?rnorm <span class="hl kwa">for</span> details.</span>
<span class="hl com"># We set the seed to 500 first to make this example reproducible. See ?set.seed</span>

<span class="hl kwd">set.seed</span>(500) 

dummy &lt;- <span class="hl kwd">rnorm</span>(
     100, 
     mean = 10, 
     sd = 2
     )

dummy
</pre></div>
<div class="output"><pre class="knitr r">##   [1] 11.937 13.931 11.773 10.061 11.899  8.847 11.443 11.238 10.042 10.550
##  [11]  7.165  6.437  8.761 11.017  6.494  7.010 10.598  9.371 11.872 12.942
##  [21]  8.278 11.936 12.111 10.383  8.579  8.531  9.837  8.265  7.183 13.598
##  [31]  6.144 12.025 12.948  9.440  8.118  9.161  6.846 12.239  9.071  7.825
##  [41]  9.193 13.635  9.913 11.663 10.376 10.541  9.155  9.284  7.831  8.981
##  [51] 12.059 11.212 14.407  8.743 12.194 10.706  9.739  6.031  9.846  6.698
##  [61] 13.209  7.628 11.346  5.878 14.270  9.226 10.270  7.655 10.923  8.793
##  [71]  8.959 11.720 10.938  5.800  7.942 13.104  8.463 11.302 10.300  8.142
##  [81] 12.904  9.892 12.065  8.235  9.052  7.915  8.826  7.321 11.194  9.468
##  [91]  8.390 11.075  8.990  7.980 12.411 11.876 12.381  7.436  8.371  6.086
</pre></div>
<div class="source"><pre class="knitr r">
<span class="hl com"># Now limit the data to two decimal places to make it easier to read</span>

dummy &lt;- <span class="hl kwd">round</span>(
     dummy, 
     digits = 2 
     )

dummy
</pre></div>
<div class="output"><pre class="knitr r">##   [1] 11.94 13.93 11.77 10.06 11.90  8.85 11.44 11.24 10.04 10.55  7.16
##  [12]  6.44  8.76 11.02  6.49  7.01 10.60  9.37 11.87 12.94  8.28 11.94
##  [23] 12.11 10.38  8.58  8.53  9.84  8.26  7.18 13.60  6.14 12.02 12.95
##  [34]  9.44  8.12  9.16  6.85 12.24  9.07  7.83  9.19 13.63  9.91 11.66
##  [45] 10.38 10.54  9.15  9.28  7.83  8.98 12.06 11.21 14.41  8.74 12.19
##  [56] 10.71  9.74  6.03  9.85  6.70 13.21  7.63 11.35  5.88 14.27  9.23
##  [67] 10.27  7.66 10.92  8.79  8.96 11.72 10.94  5.80  7.94 13.10  8.46
##  [78] 11.30 10.30  8.14 12.90  9.89 12.06  8.24  9.05  7.91  8.83  7.32
##  [89] 11.19  9.47  8.39 11.08  8.99  7.98 12.41 11.88 12.38  7.44  8.37
## [100]  6.09
</pre></div>
<div class="source"><pre class="knitr r">
<span class="hl com"># Calculate the mean of this vector</span>

<span class="hl kwd">mean</span>(dummy)
</pre></div>
<div class="output"><pre class="knitr r">## [1] 9.858
</pre></div>
<div class="source"><pre class="knitr r">
<span class="hl com"># Calculate the mean of this vector</span>

<span class="hl kwd">sd</span>(dummy)
</pre></div>
<div class="output"><pre class="knitr r">## [1] 2.124
</pre></div>
<div class="source"><pre class="knitr r">
<span class="hl com"># Let's also plot a probability density <span class="hl kwa">function</span> of this data to see what it looks like:</span>

<span class="hl kwd">plot</span>(
     <span class="hl kwd">density</span>(dummy), # create density estimates <span class="hl kwa">for</span> the dummy datsset
     lwd = 2   <span class="hl com"># set the line weight to 2 pixels</span>
     )

<span class="hl com"># and draw on the mean and mean +- standard deviation</span>

<span class="hl kwd">abline</span>(
     v = <span class="hl kwd">c</span>(
          <span class="hl kwd">mean</span>(dummy),
          <span class="hl kwd">mean</span>(dummy)+<span class="hl kwd">sd</span>(dummy),
          <span class="hl kwd">mean</span>(dummy)-<span class="hl kwd">sd</span>(dummy)
          ),
     col = <span class="hl kwd">c</span>(
          <span class="hl str">"blue"</span>, 
          <span class="hl str">"red"</span>, 
          <span class="hl str">"red"</span>
          ),
     lwd = <span class="hl kwd">c</span>(
          3, 
          2, 
          2
          ),
     lty = 2
     )
</pre></div>
</div><div class="rimage default"><img src="figure/unnamed-chunk-4.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r">

</pre></div>
</div></div>


<p>Now let us suppose that we wanted to know which of the values within the dummy data lie above or below 1 standard deviation of the mean. i.e. to the left (below) or to the right (above) the red dotted lines in our plot.</p>

<p>Suppose that we also want to create vector which contained a simple 'ABOVE' or 'BELOW' to accompany it.</p>

<p>This can be achieved with an <b>if else</b> statement nested within a <b>for</b> loop.</p>

<div class="chunk" id="unnamed-chunk-5"><div class="rcode"><div class="source"><pre class="knitr r">
<span class="hl com"># First the <span class="hl kwa">if</span> statement: let's start by using the last value of the dummy</span>
<span class="hl com"># data:</span>



<span class="hl kwd"><span class="hl kwa">if</span></span> (dummy[100] &gt; (<span class="hl kwd">mean</span>(dummy) + <span class="hl kwd">sd</span>(dummy))) {
    
    <span class="hl kwd">print</span>(<span class="hl str">"ABOVE"</span>)
    
}
</pre></div>
</div></div>


<p> And... nothing happens... because the last value of dummy is <code class="knitr inline">6.09</code>; less than the mean of dummy. But is it less than the mean - 1 standard deviation? We add an <b>else if</b> statement to decide.


<div class="chunk" id="unnamed-chunk-6"><div class="rcode"><div class="source"><pre class="knitr r">
<span class="hl kwd"><span class="hl kwa">if</span></span> (dummy[100] &gt; (<span class="hl kwd">mean</span>(dummy) + <span class="hl kwd">sd</span>(dummy))) {
    
    <span class="hl kwd">print</span>(<span class="hl str">"ABOVE"</span>)
    
} <span class="hl kwa">else</span> <span class="hl kwd"><span class="hl kwa">if</span></span> (dummy[100] &lt; (<span class="hl kwd">mean</span>(dummy) - <span class="hl kwd">sd</span>(dummy))) {
    
    <span class="hl kwd">print</span>(<span class="hl str">"BELOW"</span>)
    
}
</pre></div>
<div class="output"><pre class="knitr r">## [1] "BELOW"
</pre></div>
</div></div>



<p>There is a third possibility - the values are within the red lines in our plot - i.e. within one standard deviation of the mean. We can add an else statement to deal with this eventuality too.</p>

<div class="chunk" id="unnamed-chunk-7"><div class="rcode"><div class="source"><pre class="knitr r">
<span class="hl kwd"><span class="hl kwa">if</span></span> (dummy[100] &gt; (<span class="hl kwd">mean</span>(dummy) + <span class="hl kwd">sd</span>(dummy))) {
    
    <span class="hl kwd">print</span>(<span class="hl str">"ABOVE"</span>)
    
} <span class="hl kwa">else</span> <span class="hl kwd"><span class="hl kwa">if</span></span> (dummy[100] &lt; (<span class="hl kwd">mean</span>(dummy) - <span class="hl kwd">sd</span>(dummy))) {
    
    <span class="hl kwd">print</span>(<span class="hl str">"BELOW"</span>)
    
} <span class="hl kwa">else</span> 
<span class="hl kwd">print</span>(<span class="hl str">"WITHIN"</span>)
</pre></div>
<div class="output"><pre class="knitr r">## [1] "BELOW"
</pre></div>
</div></div>


<p>So it turns out that the first value of the dummy data is below one standard deviation of the mean.</p>

<p>Now let's wrap the <b>if else</b> statement with a <b>for</b> loop, and run it over the whole dummy dataset.</p>


<div class="chunk" id="unnamed-chunk-8"><div class="rcode"><div class="source"><pre class="knitr r">
<span class="hl com"># first we must specify what we want to the loop to iterate over:</span>

<span class="hl kwd"><span class="hl kwa">for</span></span> (i <span class="hl kwa">in</span> dummy) {
    <span class="hl com"># it's usual to name the indexer as i</span>
    
    <span class="hl com"># we replace dummy[100] with i <span class="hl kwa">in</span> both instances</span>
    
    <span class="hl kwd"><span class="hl kwa">if</span></span> (i &gt; (<span class="hl kwd">mean</span>(dummy) + <span class="hl kwd">sd</span>(dummy))) {
        
        <span class="hl kwd">print</span>(<span class="hl str">"ABOVE"</span>)
        
    } <span class="hl kwa">else</span> <span class="hl kwd"><span class="hl kwa">if</span></span> (i &lt; (<span class="hl kwd">mean</span>(dummy) - <span class="hl kwd">sd</span>(dummy))) {
        
        <span class="hl kwd">print</span>(<span class="hl str">"BELOW"</span>)
        
    } <span class="hl kwa">else</span> 
    <span class="hl kwd">print</span>(<span class="hl str">"WITHIN"</span>)
    
}
</pre></div>
<div class="output"><pre class="knitr r">## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "BELOW"
## [1] "BELOW"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "BELOW"
## [1] "BELOW"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "BELOW"
## [1] "ABOVE"
## [1] "BELOW"
## [1] "ABOVE"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "BELOW"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "BELOW"
## [1] "WITHIN"
## [1] "BELOW"
## [1] "ABOVE"
## [1] "BELOW"
## [1] "WITHIN"
## [1] "BELOW"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "BELOW"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "BELOW"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "BELOW"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "WITHIN"
## [1] "ABOVE"
## [1] "BELOW"
## [1] "WITHIN"
## [1] "BELOW"
</pre></div>
</div></div>



<p>So we get a list of "ABOVE", "BELOW" or "WITHIN". To make this really useful, we should need to get the loop to produce an output. There are several ways to do this, but a simple way is shown in the next example.</p>

<div class="chunk" id="unnamed-chunk-9"><div class="rcode"><div class="source"><pre class="knitr r">
<span class="hl com"># First we create a vector into which we will store the answers.</span>

dummy_sd &lt;- <span class="hl kwd">vector</span>(length = 100, mode = <span class="hl str">"character"</span>)


<span class="hl com"># Instead of interating directly over the dummy vector, this time, we need</span>
<span class="hl com"># to iterate over a vectore of numbers, the same length as the dummy data.</span>

<span class="hl kwd"><span class="hl kwa">for</span></span> (i <span class="hl kwa">in</span> 1:<span class="hl kwd">length</span>(dummy)) {
    
    # now we need to change i back to dummy - but use <span class="hl str">'i'</span> as subscript:
    
    <span class="hl kwd"><span class="hl kwa">if</span></span> (dummy[i] &gt; (<span class="hl kwd">mean</span>(dummy) + <span class="hl kwd">sd</span>(dummy))) {
        
        <span class="hl com"># instead of printing the results, we assign them to a subscript within</span>
        <span class="hl com"># the dummy_sd vector</span>
        
        dummy_sd[i] &lt;- <span class="hl str">"ABOVE"</span>
        
    } <span class="hl kwa">else</span> <span class="hl kwd"><span class="hl kwa">if</span></span> (dummy[i] &lt; (<span class="hl kwd">mean</span>(dummy) - <span class="hl kwd">sd</span>(dummy))) {
        
        
        dummy_sd[i] &lt;- <span class="hl str">"BELOW"</span>
        
    } <span class="hl kwa">else</span> 
    
    dummy_sd[i] &lt;- <span class="hl str">"WITHIN"</span>
    
}

<span class="hl com"># Check the results</span>

dummy_data &lt;- <span class="hl kwd">data.frame</span>(data = dummy, sd = dummy_sd)

dummy_data
</pre></div>
<div class="output"><pre class="knitr r">##      data     sd
## 1   11.94 WITHIN
## 2   13.93  ABOVE
## 3   11.77 WITHIN
## 4   10.06 WITHIN
## 5   11.90 WITHIN
## 6    8.85 WITHIN
## 7   11.44 WITHIN
## 8   11.24 WITHIN
## 9   10.04 WITHIN
## 10  10.55 WITHIN
## 11   7.16  BELOW
## 12   6.44  BELOW
## 13   8.76 WITHIN
## 14  11.02 WITHIN
## 15   6.49  BELOW
## 16   7.01  BELOW
## 17  10.60 WITHIN
## 18   9.37 WITHIN
## 19  11.87 WITHIN
## 20  12.94  ABOVE
## 21   8.28 WITHIN
## 22  11.94 WITHIN
## 23  12.11  ABOVE
## 24  10.38 WITHIN
## 25   8.58 WITHIN
## 26   8.53 WITHIN
## 27   9.84 WITHIN
## 28   8.26 WITHIN
## 29   7.18  BELOW
## 30  13.60  ABOVE
## 31   6.14  BELOW
## 32  12.02  ABOVE
## 33  12.95  ABOVE
## 34   9.44 WITHIN
## 35   8.12 WITHIN
## 36   9.16 WITHIN
## 37   6.85  BELOW
## 38  12.24  ABOVE
## 39   9.07 WITHIN
## 40   7.83 WITHIN
## 41   9.19 WITHIN
## 42  13.63  ABOVE
## 43   9.91 WITHIN
## 44  11.66 WITHIN
## 45  10.38 WITHIN
## 46  10.54 WITHIN
## 47   9.15 WITHIN
## 48   9.28 WITHIN
## 49   7.83 WITHIN
## 50   8.98 WITHIN
## 51  12.06  ABOVE
## 52  11.21 WITHIN
## 53  14.41  ABOVE
## 54   8.74 WITHIN
## 55  12.19  ABOVE
## 56  10.71 WITHIN
## 57   9.74 WITHIN
## 58   6.03  BELOW
## 59   9.85 WITHIN
## 60   6.70  BELOW
## 61  13.21  ABOVE
## 62   7.63  BELOW
## 63  11.35 WITHIN
## 64   5.88  BELOW
## 65  14.27  ABOVE
## 66   9.23 WITHIN
## 67  10.27 WITHIN
## 68   7.66  BELOW
## 69  10.92 WITHIN
## 70   8.79 WITHIN
## 71   8.96 WITHIN
## 72  11.72 WITHIN
## 73  10.94 WITHIN
## 74   5.80  BELOW
## 75   7.94 WITHIN
## 76  13.10  ABOVE
## 77   8.46 WITHIN
## 78  11.30 WITHIN
## 79  10.30 WITHIN
## 80   8.14 WITHIN
## 81  12.90  ABOVE
## 82   9.89 WITHIN
## 83  12.06  ABOVE
## 84   8.24 WITHIN
## 85   9.05 WITHIN
## 86   7.91 WITHIN
## 87   8.83 WITHIN
## 88   7.32  BELOW
## 89  11.19 WITHIN
## 90   9.47 WITHIN
## 91   8.39 WITHIN
## 92  11.08 WITHIN
## 93   8.99 WITHIN
## 94   7.98 WITHIN
## 95  12.41  ABOVE
## 96  11.88 WITHIN
## 97  12.38  ABOVE
## 98   7.44  BELOW
## 99   8.37 WITHIN
## 100  6.09  BELOW
</pre></div>
</div></div>


<h2>Writing a function</h2>

<p>Ok, so far so good, but it would be better if we could write our code in such a way that we can apply it to any vector of values, not just the one we specify..

<p>In fact, there are already functions built into R, which make the job much easier, for instance <b>sapply</b></p>

<div class="chunk" id="unnamed-chunk-10"><div class="rcode"><div class="source"><pre class="knitr r">

# We assign a name to the vector which our <span class="hl kwa">function</span> will produce, using <span class="hl str">'gets'</span> (&lt;-)
<span class="hl com"># Then we state the vector on which we want to evaluate our <span class="hl kwa">function</span> - <span class="hl kwa">in</span> this case our vector of dummy values.</span>

dummy_sd1 &lt;- <span class="hl kwd">sapply</span>(dummy, 
       
       <span class="hl com"># then we need to wrap our <span class="hl kwa">for</span> loop and <span class="hl kwa">if</span> statements <span class="hl kwa">in</span> a <span class="hl kwa">function</span> wrapper</span>
       
           <span class="hl kwd"><span class="hl kwa">function</span></span>(x) {
            
            <span class="hl kwd"><span class="hl kwa">if</span></span> (x &gt; (<span class="hl kwd">mean</span>(dummy) + <span class="hl kwd">sd</span>(dummy))) { 
                 
                 # instead of using <span class="hl str">'print'</span> we just state the outcome
                 
                 <span class="hl str">"ABOVE"</span>
                 
                 } <span class="hl kwa">else</span> <span class="hl kwd"><span class="hl kwa">if</span></span> (x &lt; (<span class="hl kwd">mean</span>(dummy) - <span class="hl kwd">sd</span>(dummy))) {
                      
                      
                      <span class="hl str">"BELOW"</span>
                      
                      } else
                           
                           
                           <span class="hl str">"WITHIN"</span>
            
            }
       )


<span class="hl com"># check <span class="hl kwa">if</span> the answer is the same as the previous example</span>

<span class="hl kwd">identical</span>(dummy_sd,dummy_sd1)
</pre></div>
<div class="output"><pre class="knitr r">## [1] TRUE
</pre></div>
<div class="source"><pre class="knitr r">


<span class="hl com"># now we can a</span>
</pre></div>
</div></div>



length(which(dummy > mean(dummy)))


length(which(dummy > (mean(dummy) + sd(dummy))))/length(dummy)


system.time()

end.rcode-->


</body>
</html>
